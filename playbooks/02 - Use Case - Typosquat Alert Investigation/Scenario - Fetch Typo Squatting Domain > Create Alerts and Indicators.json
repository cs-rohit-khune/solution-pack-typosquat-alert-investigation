{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Scenario - Fetch Typo Squatting Domain > Create Alerts and Indicators",
    "aliasName": null,
    "tag": null,
    "description": "Create Alerts and Indicators of Typo Squatting",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "squatting_hit"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/d796b91e-0878-4a44-9e4b-3d8d0dcded31",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/14472a5f-9650-4223-a161-9fac6d5f4639",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Create Demo Alerts",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.input.params['squatting_hit']}}",
                    "__bulk": true,
                    "parallel": false,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "name": "Typo Domain Detected - {{vars.item['similar_domain']}}",
                    "type": "\/api\/3\/picklists\/0b3ef6f9-eb29-4ab9-ac98-98364bd1a3aa",
                    "state": "\/api\/3\/picklists\/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "domain": "{{vars.item['similar_domain']}}",
                    "source": "FortiRecon Brand Protection",
                    "status": "\/api\/3\/picklists\/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "severity": "{{\"Severity\" | picklist(vars.item['suspicious_status'], \"@id\")}}",
                    "sourceId": "{{vars.item.id}}",
                    "sourceIp": "{{vars.item['dns_a']}}",
                    "__replace": "false",
                    "recordTags": "{% set _list = [\"FortiRecon\",\"Brand Protection\",\"Typo Squatting\"] %}{% set _dummy = _list.append(vars.item.keyword) %}{{_list}}",
                    "sourcedata": "{{vars.item | toJSON}}",
                    "description": "<p>The newly detected typo domain <b>{{vars.item['similar_domain']}}<\/b> found to be Highly Suspicious. Refer to the following details of the same:<\/p>\n<br>\n<table>\n<tbody>\n<tr>\n<th><b>Typo Domain<\/b><\/th>\n<td>{{vars.item['similar_domain']}}<\/td>\n<\/tr>\n<tr>\n<th><b>Original Domain<\/b><\/th>\n<td>{{vars.item['original_domain']}}<\/td>\n<\/tr>\n<tr>\n<th><b>Severity Score<\/b><\/th>\n<td>{{vars.item['score']}}<\/td>\n<\/tr>\n<tr>\n<th><b>Status<\/b><\/th>\n<td>{{vars.item['suspicious_status']}}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<br>\n<p>Please verify and raise a request to takedown this typo domain.<\/p>\n",
                    "ackSlaStatus": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                    "respSlaStatus": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                    "priorityWeight": 1,
                    "escalatedtoincident": "\/api\/3\/picklists\/2128a09c-153d-4db3-985d-de6be33deae5",
                    "resolvedAutomatedly": false,
                    "alertRemainingAckSLA": 0
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/upsert\/alerts",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "createdAlertsIRIList": "{{vars.result | json_query('[].\"@id\"')}}"
                }
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "10c1bed2-408a-4b5f-a879-363924fa4f74"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Indicator",
            "description": null,
            "arguments": {
                "resource": {
                    "tlp": "\/api\/3\/picklists\/7bff95b7-6438-4b01-b23a-0fe8cb5b33d3",
                    "value": "{{vars.input.params['squatting_hit'][0].original_domain}}",
                    "alerts": "{{vars.steps.Create_Demo_Alerts[0]['@id']}}",
                    "__replace": "true",
                    "indicatorStatus": "\/api\/3\/picklists\/2f5cff61-fbff-4bb3-96be-302b78a9fb47",
                    "typeofindicator": "\/api\/3\/picklists\/5a5a7d42-be27-4903-858a-19909ebfa1eb",
                    "enrichmentStatus": "\/api\/3\/picklists\/a6d9da29-27b1-4b8a-965d-8d91518540d5"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/upsert\/indicators",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "b89903a4-c61f-4bdd-8996-285cc8746fe5"
        },
        {
            "@type": "WorkflowStep",
            "name": "Return Alert IRI",
            "description": null,
            "arguments": {
                "alert_iri": "{{vars.steps.Create_Demo_Alerts[0]['@id']}}"
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "86a4cab2-58a2-4f32-be72-3b9fe4553d5f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": []
                    }
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "14472a5f-9650-4223-a161-9fac6d5f4639"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Create Demo Alerts -> Create Indicator",
            "targetStep": "\/api\/3\/workflow_steps\/b89903a4-c61f-4bdd-8996-285cc8746fe5",
            "sourceStep": "\/api\/3\/workflow_steps\/10c1bed2-408a-4b5f-a879-363924fa4f74",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "39cb31dd-d4b8-4619-aa44-15d100028bc8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Indicator -> Return Record IRI",
            "targetStep": "\/api\/3\/workflow_steps\/86a4cab2-58a2-4f32-be72-3b9fe4553d5f",
            "sourceStep": "\/api\/3\/workflow_steps\/b89903a4-c61f-4bdd-8996-285cc8746fe5",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "77d21460-513e-4493-9cec-2bbdfd9c5850"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Create Demo Alerts",
            "targetStep": "\/api\/3\/workflow_steps\/10c1bed2-408a-4b5f-a879-363924fa4f74",
            "sourceStep": "\/api\/3\/workflow_steps\/14472a5f-9650-4223-a161-9fac6d5f4639",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "78bd1ee5-8202-4550-a3c3-b5675bfc811a"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "24c9c561-c291-45f9-90fe-72c566d26452",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Referenced",
        "Scenario"
    ]
}